# kakko-de Feature Roadmap

## Goal

Enable kakko-de to execute plans generated by Claude Code for simple coding tasks.

---

## Current State

### Implemented Tools (3)

| Tool | Function |
|------|----------|
| `write_file` | Overwrite entire file |
| `read_file` | Read file contents |
| `list_dir` | List directory contents |

### Missing Tools (Required for Plan Execution)

| Tool | Function | Claude Code Equivalent |
|------|----------|------------------------|
| `grep_search` | Search file contents with regex | Grep tool |
| `edit_file` | Partial file editing (find & replace) | Edit tool |
| `execute_command` | Run shell commands | Bash tool |

---

## Recommended Implementation Order

### Phase 1: Foundation Improvements

| Order | Issue | Title | Size |
|-------|-------|-------|------|
| 1 | [#53](https://github.com/toku345/kakko-de/issues/53) | refactor: separate echo feature | S |
| 2 | [#50](https://github.com/toku345/kakko-de/issues/50) | Improve safe-invoke error handling | S |

**Why first?** Clean up technical debt before adding new features.

### Phase 2: Core Tools (Required)

| Order | Issue | Title | Size |
|-------|-------|-------|------|
| 3 | [#55](https://github.com/toku345/kakko-de/issues/55) | feat: Add grep_search tool | M |
| 4 | [#57](https://github.com/toku345/kakko-de/issues/57) | feat: Add edit_file tool | M |

**Why this order?** `grep_search` is simpler and useful for finding code to edit.

### Phase 3: Security + Command Execution

| Order | Issue | Title | Size |
|-------|-------|-------|------|
| 5 | [#23](https://github.com/toku345/kakko-de/issues/23) | Add path restrictions | M |
| 6 | [#56](https://github.com/toku345/kakko-de/issues/56) | feat: Add execute_command tool | M |

**Why this order?** Security controls should be in place before adding shell execution.

### Phase 4: Architecture Refactoring (Optional)

| Order | Issue | Title | Size |
|-------|-------|-------|------|
| 7 | [#47](https://github.com/toku345/kakko-de/issues/47) | Introduce OutputHandler protocol | M |
| 8 | [#48](https://github.com/toku345/kakko-de/issues/48) | Make chat-step pure | M |

**Why optional?** These improve testability and extensibility but are not required for basic plan execution.

---

## Dependency Graph

```
#47 (OutputHandler protocol)
  └── #48 (chat-step pure) - depends on #47

#50 (safe-invoke error handling)
  └── #54 (stderr output) - subset of #50

#23 (path restrictions)
  └── #56 (execute_command) - security foundation needed
```

---

## Milestone: Minimum Viable Plan Executor

After completing **Phase 1-3**, kakko-de will be able to:

- [x] Read files (`read_file`)
- [x] List directories (`list_dir`)
- [x] Write new files (`write_file`)
- [ ] Search code patterns (`grep_search`) - #55
- [ ] Edit existing files (`edit_file`) - #57
- [ ] Run git commands (`execute_command`) - #56
- [ ] Run tests (`execute_command`) - #56

---

## Other Open Issues (Lower Priority)

| Issue | Title | Notes |
|-------|-------|-------|
| #41 | Add Malli schemas for LLM Request/Response | Quality improvement |
| #49 | Add Malli schema for ChatStepResult | After #48 |
| #52 | Support OpenAI Responses API | New API support |
| #29 | Add Malli schema constraints for FileSystem | Schema consistency |
| #10 | Add DI support for print function | May be solved by #47 |
| #13 | Use explicit option maps | Large refactor |
| #19 | Consider explicit :result key | Design consideration |
| #31, #33, #36 | docs/tests improvements | Can be done anytime |
| #8 | Add error handling to LLM client | Quality improvement |

---

*Last updated: 2026-01-25*
